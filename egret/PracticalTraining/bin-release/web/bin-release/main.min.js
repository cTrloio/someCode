var __extends=this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},__define=this.__define||function(t,e,r,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:r,set:i})},Background=function(t){function e(e){t.call(this),"level0"==e&&(this.bg=Factory.createBitmapByName("levelStart"),this.addChild(this.bg)),"level1"==e&&(this.bg=Factory.createBitmapByName("levelOne"),this.addChild(this.bg)),"level2"==e&&(this.bg=Factory.createBitmapByName("levelTwo"),this.addChild(this.bg)),"level3"==e&&(this.bg=Factory.createBitmapByName("levelThree"),this.addChild(this.bg)),"level4"==e&&(this.bg=Factory.createBitmapByName("levelEnd"),this.addChild(this.bg))}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(Background,"Background");var BorderBox=function(t){function e(e){t.call(this),"her"==e&&(this.bg=Factory.createBitmapByName("herBorder"),this.addChild(this.bg)),"ver"==e&&(this.bg=Factory.createBitmapByName("verBorder"),this.addChild(this.bg))}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(BorderBox,"BorderBox");var Character=function(t){function e(){t.call(this),this.vx=0,this.vy=0,this.life=3,this.character=Factory.createBitmapByName("character"),this.addChild(this.character),this.character.anchorOffsetX=this.character.width/2,this.character.anchorOffsetY=this.character.height/2,this.character.scaleX=.5,this.character.scaleY=.5,this.timer=new egret.Timer(2e3)}__extends(e,t);var r=e;return p=r.prototype,p.charaDown=function(){this.character.visible=!1,this.character2=Factory.createBitmapByName("character2"),this.addChild(this.character2),this.character2.anchorOffsetX=this.character2.width/2,this.character2.anchorOffsetY=this.character2.height/2,this.character2.scaleX=.5,this.character2.scaleY=.5,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHd,this),this.timer.start()},p.timerHd=function(){this.character2.visible=!1,this.character.visible=!0,this.timer.reset(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHd,this)},e}(egret.Sprite);egret.registerClass(Character,"Character");var Collision=function(){function t(){}var e=t;return p=e.prototype,t.block=function(t,e){var r=t.x+t.width/2-(e.x+e.width/2),i=t.y+t.height/2-(e.y+e.height/2);if(Math.abs(r)<t.width/2+e.width/2)if(Math.abs(i)<t.height/2+e.height/2){var h=t.width/2+e.width/2-Math.abs(r),s=t.height/2+e.height/2-Math.abs(i);h>=s?i>0?(this.collisionSide="Top",t.y+=s):(this.collisionSide="Bottom",t.y-=s):r>0?(this.collisionSide="Left",t.x+=h):(this.collisionSide="Right",t.x-=h)}else this.collisionSide="No collision";else this.collisionSide="No collision"},t.collisionSide=" ",t}();egret.registerClass(Collision,"Collision");var Door=function(t){function e(e){t.call(this),this.door1=Factory.createBitmapByName("doorOpen"),this.addChild(this.door1),this.door1.visible=!1,this.door2=Factory.createBitmapByName("doorClose"),this.addChild(this.door2),this.door1.anchorOffsetX=this.door1.width/2,this.door1.anchorOffsetY=this.door1.height/2,this.door2.anchorOffsetX=this.door2.width/2,this.door2.anchorOffsetY=this.door2.height/2,this.door1.alpha=.6,this.door2.alpha=.6,"sta"==e&&(this.door1.scaleX=.8,this.door1.scaleY=.8,this.door2.scaleX=.8,this.door2.scaleY=.8),"one"==e&&(this.door1.scaleX=.7,this.door1.scaleY=.7,this.door1.alpha=.7,this.door2.alpha=.7,this.door2.scaleX=.7,this.door2.scaleY=.7),"two"==e&&(this.door1.scaleX=.5,this.door1.scaleY=.5,this.door2.scaleX=.5,this.door2.scaleY=.5),"three"==e&&(this.door1.scaleX=.4,this.door1.scaleY=.4,this.door2.scaleX=.4,this.door2.scaleY=.4)}__extends(e,t);var r=e;return p=r.prototype,p.checkOpen=function(){this.doorIsOpen?(this.door1.visible=!0,this.door2.visible=!1):(this.door2.visible=!0,this.door1.visible=!1)},e}(egret.Sprite);egret.registerClass(Door,"Door");var End=function(t){function e(e){t.call(this),"one"==e&&(this.end=Factory.createBitmapByName("endPlace1"),this.addChild(this.end),this.end.scaleX=.5,this.end.scaleY=.5,this.end.anchorOffsetX=this.end.width/2,this.end.anchorOffsetY=this.end.height/2),"two"==e&&(this.end=Factory.createBitmapByName("endPlace2"),this.addChild(this.end),this.end.scaleX=.3,this.end.scaleY=.3,this.end.anchorOffsetX=this.end.width/2,this.end.anchorOffsetY=this.end.height/2),"three"==e&&(this.end=Factory.createBitmapByName("endPlace3"),this.addChild(this.end),this.end.scaleX=.3,this.end.scaleY=.3,this.end.anchorOffsetX=this.end.width/2,this.end.anchorOffsetY=this.end.height/2)}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(End,"End");var Enemy=function(t){function e(e){t.call(this),this.vx=0,this.vy=0,"soul1"==e&&(this.enemy1=Factory.createBitmapByName("enemySoul"),this.addChild(this.enemy1),this.enemy1.anchorOffsetX=this.enemy1.width/2,this.enemy1.anchorOffsetY=this.enemy1.height/2,this.enemy1.scaleX=.7,this.enemy1.scaleY=.7),"soul2"==e&&(this.enemy1=Factory.createBitmapByName("enemyTwo"),this.addChild(this.enemy1),this.enemy1.anchorOffsetX=this.enemy1.width/2,this.enemy1.anchorOffsetY=this.enemy1.height/2,this.enemy1.scaleX=.7,this.enemy1.scaleY=.7)}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(Enemy,"Enemy");var Factory=function(){function t(){}var e=t;return p=e.prototype,t.createBitmapByName=function(t){var e=new egret.Bitmap,r=RES.getRes(t);return e.texture=r,e},t}();egret.registerClass(Factory,"Factory");var GameOver=function(t){function e(){t.call(this),this.vy=0,this.gameover=Factory.createBitmapByName("gameOver"),this.addChild(this.gameover),this.gameover.anchorOffsetX=this.gameover.width/2}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(GameOver,"GameOver");var LevelEnd=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){this.createGameScene()},p.createGameScene=function(){this.addObject(),this.addEventHd()},p.addEventHd=function(){this.textTimer=new egret.Timer(4500),this.textTimer.addEventListener(egret.TimerEvent.TIMER,this.gameOverTimer,this),this.textTimer.start(),this.addEventListener(egret.Event.ENTER_FRAME,this.enterHd,this)},p.addObject=function(){this.bg=new Background("level4"),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.gameover=new GameOver,this.addChild(this.gameover),this.gameover.x=400,this.gameover.y=600},p.enterHd=function(){this.gameover.vy=6,this.gameover.y-=this.gameover.vy,this.gameover.y<150&&(this.gameover.y=150)},p.gameOverTimer=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterHd,this),this.textTimer.removeEventListener(egret.TimerEvent.TIMER,this.gameOverTimer,this),this.dispatchEvent(new egret.Event("levelEndComplete"))},e}(egret.Sprite);egret.registerClass(LevelEnd,"LevelEnd");var LevelOne=function(t){function e(){t.call(this),this.doorArr=[],this.borderArr=[],this.currNum=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){this.createGameScene()},p.createGameScene=function(){this.addObject(),this.addEventHd()},p.addEventHd=function(){this.textTimer=new egret.Timer(1e3),this.textTimer.addEventListener(egret.TimerEvent.TIMER,this.numTimer,this),this.textTimer.start();var t=this;document.addEventListener("keydown",function(e){t.onKeyDOWN(e)}),document.addEventListener("keyup",function(e){t.onKeyUP(e)}),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},p.addObject=function(){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.loadOver,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest("resource/music/lev1.mp3")),this.loader3=new egret.URLLoader,this.loader3.addEventListener(egret.Event.COMPLETE,this.loadOver3,this),this.loader3.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader3.load(new egret.URLRequest("resource/music/bobo.wav")),this.charaPosArrX=[200,600,200,600],this.charaPosArrY=[530,530,230,230],this.bg=new Background("level1"),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.destination=new End("one"),this.destination.x=450,this.destination.y=230,this.addChild(this.destination),this.chara=new Character,this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.addChild(this.chara),this.borderBox1=new BorderBox("her"),this.borderBox2=new BorderBox("her"),this.borderBox3=new BorderBox("her"),this.borderBox4=new BorderBox("ver"),this.borderBox5=new BorderBox("ver"),this.borderBox6=new BorderBox("ver"),this.borderBox1.x=0,this.borderBox1.y=this.borderBox1.height/2+25,this.borderBox2.x=0,this.borderBox2.y=300-this.borderBox2.height/2+25,this.borderBox3.x=0,this.borderBox3.y=600-this.borderBox3.height/2+20,this.borderBox4.x=this.borderBox4.width/2+20,this.borderBox4.y=0,this.borderBox5.x=400-this.borderBox4.width/2+25,this.borderBox5.y=0,this.borderBox6.x=800-this.borderBox4.width/2+20,this.borderBox6.y=0,this.addChild(this.borderBox1),this.addChild(this.borderBox2),this.addChild(this.borderBox3),this.addChild(this.borderBox4),this.addChild(this.borderBox5),this.addChild(this.borderBox6),this.borderArr.push(this.borderBox1),this.borderArr.push(this.borderBox2),this.borderArr.push(this.borderBox3),this.borderArr.push(this.borderBox4),this.borderArr.push(this.borderBox5),this.borderArr.push(this.borderBox6),this.door1=new Door("one"),this.door1.x=350,this.door1.y=530,this.addChild(this.door1),this.door2=new Door("one"),this.door2.x=550,this.door2.y=530,this.addChild(this.door2),this.door3=new Door("one"),this.door3.x=350,this.door3.y=230,this.addChild(this.door3),this.doorArr.push(this.door1),this.doorArr.push(this.door2),this.doorArr.push(this.door3),this.door4=new Door("one"),this.door4.x=450,this.door4.y=530,this.addChild(this.door4),this.door5=new Door("one"),this.door5.x=750,this.door5.y=530,this.addChild(this.door5),this.door6=new Door("one"),this.door6.x=150,this.door6.y=230,this.addChild(this.door6),this.door7=new Door("one"),this.door7.x=50,this.door7.y=230,this.addChild(this.door7),this.door8=new Door("one"),this.door8.x=750,this.door8.y=230,this.addChild(this.door8),this.doorArr.push(this.door4),this.doorArr.push(this.door5),this.doorArr.push(this.door6),this.doorArr.push(this.door7),this.doorArr.push(this.door8)},p.loadOver=function(){this.sound=this.loader.data,this.soundChann=this.sound.play(0,0)},p.loadOver3=function(){this.sound3=this.loader3.data},p.onKeyDOWN=function(){37==event.keyCode&&(this.chara.vx=-5),39==event.keyCode&&(this.chara.vx=5),32==event.keyCode&&(this.cross=!0)},p.onKeyUP=function(){(37==event.keyCode||39==event.keyCode)&&(this.chara.vx=0),32==event.keyCode&&(this.cross=!1)},p.enterFrame=function(){this.chara.x+=this.chara.vx,this.chara.y+=this.chara.vy,this.borderChick();for(var t=0;t<this.doorArr.length;t++)this.chara.hitTestPoint(this.doorArr[t].x,this.doorArr[t].y)?(this.doorArr[t].doorIsOpen=!0,this.doorArr[t].checkOpen()):(this.doorArr[t].doorIsOpen=!1,this.doorArr[t].checkOpen());for(var e=0;e<this.doorArr.length-5;e++)this.chara.hitTestPoint(this.doorArr[e].x,this.doorArr[e].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[e+1],this.chara.y=this.charaPosArrY[e+1]);this.chara.hitTestPoint(this.doorArr[3].x,this.doorArr[3].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0]),this.chara.hitTestPoint(this.doorArr[4].x,this.doorArr[4].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[this.currNum],this.chara.y=this.charaPosArrY[this.currNum]),this.chara.hitTestPoint(this.doorArr[5].x,this.doorArr[5].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[1],this.chara.y=this.charaPosArrY[1]),this.chara.hitTestPoint(this.doorArr[6].x,this.doorArr[6].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[this.currNum],this.chara.y=this.charaPosArrY[this.currNum]),this.chara.hitTestPoint(this.doorArr[7].x,this.doorArr[7].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[2],this.chara.y=this.charaPosArrY[2]),this.chara.hitTestPoint(this.destination.x,this.destination.y)&&this.gameOver()},p.borderChick=function(){for(var t=0;t<this.borderArr.length;t++)Collision.block(this.chara,this.borderArr[t]),"Left"==Collision.collisionSide&&(this.chara.vx=0),"Right"==Collision.collisionSide&&(this.chara.vx=0)},p.numTimer=function(){this.currNum=Math.ceil(3*Math.random()-1)},p.gameOver=function(){this.textTimer.removeEventListener(egret.TimerEvent.TIMER,this.numTimer,this),document.removeEventListener("keydown",function(t){this.onKeyDOWN(t)}),document.removeEventListener("keyup",function(t){this.onKeyUP(t)}),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.charaPosArrX.splice(0,this.charaPosArrX.length),this.charaPosArrY.splice(0,this.charaPosArrY.length),this.doorArr.splice(0,this.doorArr.length),this.borderArr.splice(0,this.borderArr.length),this.loader.removeEventListener(egret.Event.COMPLETE,this.loadOver,this),this.soundChann.stop(),this.dispatchEvent(new egret.Event("levelOneComplete"))},e}(egret.Sprite);egret.registerClass(LevelOne,"LevelOne");var LevelStart=function(t){function e(){t.call(this),this.doorArr=[],this.textArr=[],this.num=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){this.createGameScene()},p.createGameScene=function(){this.addObject(),this.addEventHd()},p.addEventHd=function(){var t=this;document.addEventListener("keydown",function(e){t.onKeyDOWN(e)}),document.addEventListener("keyup",function(e){t.onKeyUP(e)}),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.timer=new egret.Timer(500,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHd,this),this.timer.start()},p.addObject=function(){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.loadOver,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest("resource/music/lev0.mp3")),this.loader3=new egret.URLLoader,this.loader3.addEventListener(egret.Event.COMPLETE,this.loadOver3,this),this.loader3.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader3.load(new egret.URLRequest("resource/music/bobo.wav")),this.bg=new Background("level0"),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.chara=new Character,this.chara.x=400,this.chara.y=100,this.addChild(this.chara),this.door1=new Door("sta"),this.door1.x=200,this.door1.y=530,this.addChild(this.door1),this.door2=new Door("sta"),this.door2.x=600,this.door2.y=530,this.addChild(this.door2),this.doorArr.push(this.door1),this.doorArr.push(this.door2),this.text1=new TextPORTAL("p"),this.text2=new TextPORTAL("o"),this.text3=new TextPORTAL("r"),this.text4=new TextPORTAL("t"),this.text5=new TextPORTAL("a"),this.text6=new TextPORTAL("l"),this.addChild(this.text1),this.addChild(this.text2),this.addChild(this.text3),this.addChild(this.text4),this.addChild(this.text5),this.addChild(this.text6),this.textArr.push(this.text6),this.textArr.push(this.text1),this.textArr.push(this.text2),this.textArr.push(this.text4),this.textArr.push(this.text3),this.textArr.push(this.text5);for(var t=0;t<this.textArr.length;t++)this.textArr[t].y=600,this.textArr[t].x=150+80*t},p.onKeyDOWN=function(){37==event.keyCode&&(this.chara.vx=-5),38==event.keyCode&&(this.chara.vy=-5),39==event.keyCode&&(this.chara.vx=5),40==event.keyCode&&(this.chara.vy=5),32==event.keyCode&&(this.cross=!0)},p.onKeyUP=function(){(37==event.keyCode||39==event.keyCode)&&(this.chara.vx=0),(38==event.keyCode||40==event.keyCode)&&(this.chara.vy=0),32==event.keyCode&&(this.cross=!1)},p.loadOver=function(){this.sound=this.loader.data,this.soundChann=this.sound.play(0,0)},p.loadOver3=function(){this.sound3=this.loader3.data},p.enterFrame=function(){this.chara.x+=this.chara.vx,this.chara.y+=this.chara.vy,this.textArr[this.num].vy=7;for(var t=0;t<this.textArr.length;t++)this.textArr[t].y-=this.textArr[t].vy,this.textArr[t].y<150&&(this.textArr[t].y=150);this.borderChick();for(var t=0;t<this.doorArr.length;t++)this.chara.hitTestPoint(this.doorArr[t].x,this.doorArr[t].y)?(this.doorArr[t].doorIsOpen=!0,this.doorArr[t].checkOpen()):(this.doorArr[t].doorIsOpen=!1,this.doorArr[t].checkOpen());this.chara.hitTestPoint(this.door1.x,this.door1.y)&&1==this.cross&&(this.soundChann3=this.sound3.play(0,1),this.gameOver()),this.chara.hitTestPoint(this.door2.x,this.door2.y)&&1==this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=400,this.chara.x=100)},p.timerHd=function(){this.num++,this.num>5&&(this.num=5)},p.borderChick=function(){this.chara.x<25&&(this.chara.x=25),this.chara.y<25&&(this.chara.y=25),this.chara.x+this.chara.width/2>800&&(this.chara.x=800-this.chara.width/2),this.chara.y+this.chara.height/2>600&&(this.chara.y=600-this.chara.height/2)},p.gameOver=function(){document.removeEventListener("keydown",function(t){this.onKeyDOWN(t)}),document.removeEventListener("keyup",function(t){this.onKeyUP(t)}),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHd,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.loader.removeEventListener(egret.Event.COMPLETE,this.loadOver,this),this.soundChann.stop(),this.dispatchEvent(new egret.Event("LevelStartComplete"))},e}(egret.Sprite);egret.registerClass(LevelStart,"LevelStart");var LevelThree=function(t){function e(){t.call(this),this.desIstrue=!1,this.canFight=!1,this.doorArr=[],this.borderArr=[],this.currNum=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){this.createGameScene()},p.addObject=function(){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.loadOver,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest("resource/music/lev3.mp3")),this.loader2=new egret.URLLoader,this.loader2.addEventListener(egret.Event.COMPLETE,this.loadOver2,this),this.loader2.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader2.load(new egret.URLRequest("resource/music/mofabang.mp3")),this.loader3=new egret.URLLoader,this.loader3.addEventListener(egret.Event.COMPLETE,this.loadOver3,this),this.loader3.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader3.load(new egret.URLRequest("resource/music/bobo.wav")),this.loader4=new egret.URLLoader,this.loader4.addEventListener(egret.Event.COMPLETE,this.loadOver4,this),this.loader4.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader4.load(new egret.URLRequest("resource/music/hit.wav")),this.charaPosArrX=[400,400,662,662,662,400,132,132,132],this.charaPosArrY=[300,500,500,300,100,100,100,300,500],this.bg=new Background("level3"),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.destination=new End("three"),this.destination.x=335,this.destination.y=300,this.addChild(this.destination),this.destination.visible=!1,this.borderBox1=new BorderBox("her"),this.borderBox2=new BorderBox("her"),this.borderBox3=new BorderBox("her"),this.borderBox4=new BorderBox("her"),this.borderBox5=new BorderBox("ver"),this.borderBox6=new BorderBox("ver"),this.borderBox7=new BorderBox("ver"),this.borderBox8=new BorderBox("ver"),this.addChild(this.borderBox1),this.addChild(this.borderBox2),this.addChild(this.borderBox3),this.addChild(this.borderBox4),this.addChild(this.borderBox5),this.addChild(this.borderBox6),this.addChild(this.borderBox7),this.addChild(this.borderBox8),this.borderBox1.scaleY=.7,this.borderBox2.scaleY=.7,this.borderBox3.scaleY=.7,this.borderBox4.scaleY=.7,this.borderBox5.scaleX=.7,this.borderBox6.scaleX=.7,this.borderBox7.scaleX=.7,this.borderBox8.scaleX=.7,this.borderBox1.x=0,this.borderBox1.y=20,this.borderBox2.x=0,this.borderBox2.y=215,this.borderBox3.x=0,this.borderBox3.y=425,this.borderBox4.x=0,this.borderBox4.y=620,this.borderBox5.x=20,this.borderBox5.y=0,this.borderBox6.x=285,this.borderBox6.y=0,this.borderBox7.x=555,this.borderBox7.y=0,this.borderBox8.x=815,this.borderBox8.y=0,this.borderArr.push(this.borderBox1),this.borderArr.push(this.borderBox2),this.borderArr.push(this.borderBox3),this.borderArr.push(this.borderBox4),this.borderArr.push(this.borderBox5),this.borderArr.push(this.borderBox6),this.borderArr.push(this.borderBox7),this.borderArr.push(this.borderBox8),this.door1=new Door("three"),this.door2=new Door("three"),this.door3=new Door("three"),this.door4=new Door("three"),this.door5=new Door("three"),this.door6=new Door("three"),this.door7=new Door("three"),this.door8=new Door("three"),this.door9=new Door("three"),this.door1.x=465,this.door1.y=300,this.door2.x=465,this.door2.y=500,this.door3.x=595,this.door3.y=500,this.door4.x=729,this.door4.y=300,this.door5.x=729,this.door5.y=100,this.door6.x=335,this.door6.y=100,this.door7.x=197,this.door7.y=100,this.door8.x=66,this.door8.y=300,this.door9.x=197,this.door9.y=500,this.addChild(this.door1),this.addChild(this.door2),this.addChild(this.door3),this.addChild(this.door4),this.addChild(this.door5),this.addChild(this.door6),this.addChild(this.door7),this.addChild(this.door8),this.addChild(this.door9),this.doorArr.push(this.door1),this.doorArr.push(this.door2),this.doorArr.push(this.door3),this.doorArr.push(this.door4),this.doorArr.push(this.door5),this.doorArr.push(this.door6),this.doorArr.push(this.door7),this.doorArr.push(this.door8),this.doorArr.push(this.door9),this.door10=new Door("three"),this.door11=new Door("three"),this.door12=new Door("three"),this.door13=new Door("three"),this.door14=new Door("three"),this.door15=new Door("three"),this.door16=new Door("three"),this.door17=new Door("three"),this.door10.x=335,this.door10.y=500,this.door11.x=729,this.door11.y=500,this.door12.x=595,this.door12.y=300,this.door13.x=595,this.door13.y=100,this.door14.x=465,this.door14.y=100,this.door15.x=66,this.door15.y=100,this.door16.x=197,this.door16.y=300,this.door17.x=66,this.door17.y=500,this.addChild(this.door10),this.addChild(this.door11),this.addChild(this.door12),this.addChild(this.door13),this.addChild(this.door14),this.addChild(this.door15),this.addChild(this.door16),this.addChild(this.door17),this.doorArr.push(this.door10),this.doorArr.push(this.door11),this.doorArr.push(this.door12),this.doorArr.push(this.door13),this.doorArr.push(this.door14),this.doorArr.push(this.door15),this.doorArr.push(this.door16),this.doorArr.push(this.door17),this.chara=new Character,this.addChild(this.chara),this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.chara.life=3,this.enemy1=new Enemy("soul1"),this.addChild(this.enemy1),this.enemy1.x=this.charaPosArrX[5],this.enemy1.y=this.charaPosArrY[5],this.enemy2=new Enemy("soul2"),this.addChild(this.enemy2),this.enemy2.x=this.charaPosArrX[6],this.enemy2.y=this.charaPosArrY[6],this.wuqi=new WuQi,this.wuqi.x=465,this.wuqi.y=50,this.addChild(this.wuqi)},p.addEventHd=function(){this.textTimer=new egret.Timer(1e3),this.textTimer.addEventListener(egret.TimerEvent.TIMER,this.numTimer,this),this.textTimer.start(),this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHd,this),this.timer.start();var t=this;document.addEventListener("keydown",function(e){t.onKeyDOWN(e)}),document.addEventListener("keyup",function(e){t.onKeyUP(e)}),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},p.createGameScene=function(){this.addObject(),this.addEventHd()},p.loadOver=function(){this.sound=this.loader.data,this.soundChann=this.sound.play(0,0)},p.loadOver2=function(){this.sound2=this.loader2.data},p.loadOver3=function(){this.sound3=this.loader3.data},p.loadOver4=function(){this.sound4=this.loader4.data},p.onKeyDOWN=function(){37==event.keyCode&&(this.chara.vx=-5),39==event.keyCode&&(this.chara.vx=5),38==event.keyCode&&(this.chara.vy=-5),40==event.keyCode&&(this.chara.vy=5),32==event.keyCode&&(this.cross=!0)},p.onKeyUP=function(){(37==event.keyCode||39==event.keyCode)&&(this.chara.vx=0),(38==event.keyCode||40==event.keyCode)&&(this.chara.vy=0),32==event.keyCode&&(this.cross=!1)},p.enterFrame=function(){this.chara.x+=this.chara.vx,this.chara.y+=this.chara.vy,this.enemy1.x+=this.enemy1.vx,this.enemy1.y+=this.enemy1.vy,this.enemy2.x+=this.enemy2.vx,this.enemy2.y+=this.enemy2.vy,this.borderChick();for(var t=0;t<this.doorArr.length;t++)this.chara.hitTestPoint(this.doorArr[t].x,this.doorArr[t].y)?(this.doorArr[t].doorIsOpen=!0,this.doorArr[t].checkOpen()):(this.doorArr[t].doorIsOpen=!1,this.doorArr[t].checkOpen());for(var e=0;8>e;e++)this.chara.hitTestPoint(this.doorArr[e].x,this.doorArr[e].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[e+1],this.chara.y=this.charaPosArrY[e+1]);for(var r=8;17>r;r++)this.chara.hitTestPoint(this.doorArr[r].x,this.doorArr[r].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[this.currNum],this.chara.y=this.charaPosArrY[this.currNum]);this.checkStageBorder(this.enemy1),this.checkStageBorder(this.enemy2),this.chara.hitTestPoint(this.wuqi.x,this.wuqi.y)&&(this.soundChann2=this.sound2.play(0,1),this.removeChild(this.wuqi),this.chara.addChild(this.wuqi),this.wuqi.x=10,this.wuqi.y=-5,this.canFight=!0),this.hitEnemy(this.enemy1),this.hitEnemy(this.enemy2),this.chara.life<0&&this.gameOver2(),this.desIstrue&&(this.destination.visible=!0),this.chara.hitTestPoint(this.destination.x,this.destination.y)&&1==this.destination.visible&&this.gameOver2()},p.hitEnemy=function(t){this.chara.hitTestPoint(t.x,t.y)&&t.visible&&(this.canFight?(t.visible=!1,this.canFight=!1,this.wuqi.visible=!1,this.desIstrue=!0):(this.soundChann4=this.sound4.play(0,1),this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.chara.life--,this.chara.charaDown()))},p.borderChick=function(){for(var t=0;t<this.borderArr.length;t++)Collision.block(this.chara,this.borderArr[t]),"Bottom"==Collision.collisionSide&&(this.chara.vy=0),"Top"==Collision.collisionSide&&(this.chara.vy=0),"Left"==Collision.collisionSide&&(this.chara.vx=0),"Right"==Collision.collisionSide&&(this.chara.vx=0)},p.numTimer=function(){this.currNum=Math.ceil(5*Math.random()-1)},p.checkStageBorder=function(t){t.x<50&&(t.x=50),t.y<50&&(t.y=50),t.x+t.width/2>800&&(t.x=800-t.width/2),t.y+t.height/2>600&&(t.y=600-t.height/2)},p.createRandomNum1=function(t){var e=Math.ceil(4*Math.random());1==e&&(t.vx=4),2==e&&(t.vx=-4),3==e&&(t.vy=4),4==e&&(t.vy=-4)},p.createRandomNum2=function(t){var e=Math.ceil(2*Math.random());1==e&&(this.chara.x>t.x&&(t.vx=3,t.vy=0),this.chara.x<t.x&&(t.vx=-3,t.vy=0)),2==e&&(this.chara.y>t.y&&(t.vx=0,t.vy=3),this.chara.y<t.y&&(t.vx=0,t.vy=-3))},p.timerHd=function(){this.createRandomNum1(this.enemy1),this.createRandomNum2(this.enemy2)},p.gameOver2=function(){this.textTimer.removeEventListener(egret.TimerEvent.TIMER,this.numTimer,this),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHd,this);var t=this;document.removeEventListener("keydown",function(e){t.onKeyDOWN(e)}),document.removeEventListener("keyup",function(e){t.onKeyUP(e)}),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.charaPosArrX.splice(0,this.charaPosArrX.length),this.charaPosArrY.splice(0,this.charaPosArrY.length),this.doorArr.splice(0,this.doorArr.length),this.borderArr.splice(0,this.borderArr.length),this.loader.removeEventListener(egret.Event.COMPLETE,this.loadOver,this),this.soundChann.stop(),this.dispatchEvent(new egret.Event("levelThreeComplete"))},e}(egret.Sprite);egret.registerClass(LevelThree,"LevelThree");var LevelTwo=function(t){function e(){t.call(this),this.doorArr=[],this.borderArr=[],this.currNum=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){this.createGameScene()},p.createGameScene=function(){this.addObject(),this.addEventHd()},p.addEventHd=function(){this.textTimer=new egret.Timer(1e3),this.textTimer.addEventListener(egret.TimerEvent.TIMER,this.numTimer,this),this.textTimer.start(),this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHd,this),this.timer.start();var t=this;document.addEventListener("keydown",function(e){t.onKeyDOWN(e)}),document.addEventListener("keyup",function(e){t.onKeyUP(e)}),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},p.addObject=function(){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.loadOver,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest("resource/music/lev2.mp3")),this.loader3=new egret.URLLoader,this.loader3.addEventListener(egret.Event.COMPLETE,this.loadOver3,this),this.loader3.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader3.load(new egret.URLRequest("resource/music/bobo.wav")),this.loader4=new egret.URLLoader,this.loader4.addEventListener(egret.Event.COMPLETE,this.loadOver4,this),this.loader4.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader4.load(new egret.URLRequest("resource/music/hit.wav")),this.charaPosArrX=[470,735,735,200,200,470],this.charaPosArrY=[450,450,150,150,450,150],this.bg=new Background("level2"),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.destination=new End("two"),this.destination.x=300,this.destination.y=150,this.addChild(this.destination),this.chara=new Character,this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.addChild(this.chara),this.enemy1=new Enemy("soul1"),this.enemy1.x=100,this.enemy1.y=100,this.addChild(this.enemy1),this.enemy2=new Enemy("soul1"),this.enemy2.x=700,this.enemy2.y=100,this.addChild(this.enemy2),this.borderBox1=new BorderBox("her"),this.borderBox2=new BorderBox("her"),this.borderBox3=new BorderBox("her"),this.borderBox4=new BorderBox("ver"),this.borderBox5=new BorderBox("ver"),this.borderBox6=new BorderBox("ver"),this.borderBox7=new BorderBox("ver"),this.borderBox1.x=0,this.borderBox1.y=this.borderBox1.height/2+15,this.borderBox2.x=0,this.borderBox2.y=300-this.borderBox2.height/2+25,this.borderBox3.x=0,this.borderBox3.y=600-this.borderBox3.height/2+20,this.borderBox4.x=this.borderBox4.width/2+5,this.borderBox4.y=0,this.borderBox5.x=265-this.borderBox5.width/2+25,this.borderBox5.y=0,this.borderBox6.x=530-this.borderBox6.width/2+35,this.borderBox6.y=0,this.borderBox7.x=800-this.borderBox7.width/2+30,this.borderBox7.y=0,this.addChild(this.borderBox1),this.addChild(this.borderBox2),this.addChild(this.borderBox3),this.addChild(this.borderBox4),this.addChild(this.borderBox5),this.addChild(this.borderBox6),this.addChild(this.borderBox7),this.borderArr.push(this.borderBox1),this.borderArr.push(this.borderBox2),this.borderArr.push(this.borderBox3),this.borderArr.push(this.borderBox4),this.borderArr.push(this.borderBox5),this.borderArr.push(this.borderBox6),this.borderArr.push(this.borderBox7),this.door1=new Door("two"),this.door2=new Door("two"),this.door3=new Door("two"),this.door4=new Door("two"),this.door5=new Door("two"),this.door1.x=300,this.door1.y=450,this.door2.x=645,this.door2.y=450,this.door3.x=570,this.door3.y=150,this.door4.x=40,this.door4.y=150,this.door5.x=40,this.door5.y=450,this.addChild(this.door1),this.addChild(this.door2),this.addChild(this.door3),this.addChild(this.door4),this.addChild(this.door5),this.doorArr.push(this.door1),this.doorArr.push(this.door2),this.doorArr.push(this.door3),this.doorArr.push(this.door4),this.doorArr.push(this.door5),this.door6=new Door("two"),this.door7=new Door("two"),this.door8=new Door("two"),this.door9=new Door("two"),this.door10=new Door("two"),this.door6.x=570,this.door6.y=450,this.door7.x=645,this.door7.y=150,this.door8.x=130,this.door8.y=150,this.door9.x=130,this.door9.y=450,this.door10.x=400,this.door10.y=150,this.addChild(this.door6),this.addChild(this.door7),this.addChild(this.door8),this.addChild(this.door9),this.addChild(this.door10),this.doorArr.push(this.door6),this.doorArr.push(this.door7),this.doorArr.push(this.door8),this.doorArr.push(this.door9),this.doorArr.push(this.door10)
},p.loadOver=function(){this.sound=this.loader.data,this.soundChann=this.sound.play(0,0)},p.loadOver3=function(){this.sound3=this.loader3.data},p.loadOver4=function(){this.sound4=this.loader4.data},p.onKeyDOWN=function(){37==event.keyCode&&(this.chara.vx=-5),39==event.keyCode&&(this.chara.vx=5),38==event.keyCode&&(this.chara.vy=-5),40==event.keyCode&&(this.chara.vy=5),32==event.keyCode&&(this.cross=!0)},p.onKeyUP=function(){(37==event.keyCode||39==event.keyCode)&&(this.chara.vx=0),(38==event.keyCode||40==event.keyCode)&&(this.chara.vy=0),32==event.keyCode&&(this.cross=!1)},p.enterFrame=function(){this.enemy1.x+=this.enemy1.vx,this.enemy1.y+=this.enemy1.vy,this.enemy2.x+=this.enemy2.vx,this.enemy2.y+=this.enemy2.vy,this.checkStageBorder(this.enemy1),this.checkStageBorder(this.enemy2),this.chara.x+=this.chara.vx,this.chara.y+=this.chara.vy;for(var t=0;t<this.doorArr.length;t++)this.chara.hitTestPoint(this.doorArr[t].x,this.doorArr[t].y)?(this.doorArr[t].doorIsOpen=!0,this.doorArr[t].checkOpen()):(this.doorArr[t].doorIsOpen=!1,this.doorArr[t].checkOpen());for(var e=0;5>e;e++)this.chara.hitTestPoint(this.doorArr[e].x,this.doorArr[e].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[e+1],this.chara.y=this.charaPosArrY[e+1]);for(var r=5;10>r;r++)this.chara.hitTestPoint(this.doorArr[r].x,this.doorArr[r].y)&&this.cross&&(this.soundChann3=this.sound3.play(0,1),this.chara.x=this.charaPosArrX[this.currNum],this.chara.y=this.charaPosArrY[this.currNum]);this.borderChick(),this.chara.hitTestPoint(this.destination.x,this.destination.y)&&this.gameOver("next"),this.hitEnemy()},p.hitEnemy=function(){this.chara.hitTestPoint(this.enemy1.x,this.enemy1.y)&&(this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.chara.life--,this.chara.charaDown(),this.soundChann4=this.sound4.play(0,1)),this.chara.hitTestPoint(this.enemy2.x,this.enemy2.y)&&(this.chara.x=this.charaPosArrX[0],this.chara.y=this.charaPosArrY[0],this.chara.life--,this.chara.charaDown(),this.soundChann4=this.sound4.play(0,1)),this.chara.life<0&&this.gameOver("over")},p.borderChick=function(){for(var t=0;t<this.borderArr.length;t++)Collision.block(this.chara,this.borderArr[t]),"Bottom"==Collision.collisionSide&&(this.chara.vy=0),"Top"==Collision.collisionSide&&(this.chara.vy=0),"Left"==Collision.collisionSide&&(this.chara.vx=0),"Right"==Collision.collisionSide&&(this.chara.vx=0)},p.numTimer=function(){this.currNum=Math.ceil(5*Math.random()-1)},p.checkStageBorder=function(t){t.x<50&&(t.x=50),t.y<50&&(t.y=50),t.x+t.width/2>800&&(t.x=800-t.width/2),t.y+t.height/2>600&&(t.y=600-t.height/2)},p.createRandomNum=function(t){var e=Math.ceil(4*Math.random());1==e&&(t.vx=2),2==e&&(t.vx=-2),3==e&&(t.vy=2),4==e&&(t.vy=-2)},p.timerHd=function(){this.createRandomNum(this.enemy1),this.createRandomNum(this.enemy2)},p.gameOver=function(t){"next"==t&&this.dispatchEvent(new egret.Event("levelTwoComplete")),"over"==t&&this.dispatchEvent(new egret.Event("levelThreeComplete")),this.textTimer.removeEventListener(egret.TimerEvent.TIMER,this.numTimer,this),document.removeEventListener("keydown",function(t){this.onKeyDOWN(t)}),document.removeEventListener("keyup",function(t){this.onKeyUP(t)}),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),this.loader.removeEventListener(egret.Event.COMPLETE,this.loadOver,this),this.soundChann.stop(),this.charaPosArrX.splice(0,this.charaPosArrX.length),this.charaPosArrY.splice(0,this.charaPosArrY.length),this.doorArr.splice(0,this.doorArr.length),this.borderArr.splice(0,this.borderArr.length)},e}(egret.Sprite);egret.registerClass(LevelTwo,"LevelTwo");var Main=function(t){function e(){t.call(this),this.level0=null,this.level1=null,this.level2=null,this.level3=null,this.level4=null,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var r=e;return p=r.prototype,p.onAddToStage=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},p.onResourceLoadComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},p.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},p.onResourceProgress=function(t){"preload"==t.groupName},p.createGameScene=function(){null!=this.level4&&this.removeChild(this.level4),this.level0=new LevelStart,this.addChild(this.level0),this.level0.addEventListener("LevelStartComplete",this.removeStartLevel,this)},p.removeStartLevel=function(){this.removeChild(this.level0),this.level1=new LevelOne,this.addChild(this.level1),this.level1.addEventListener("levelOneComplete",this.removeLevelOne,this)},p.removeLevelOne=function(){null!=this.level1&&this.removeChild(this.level1),this.level2=new LevelTwo,this.addChild(this.level2),this.level2.addEventListener("levelTwoComplete",this.removeLevelTwo,this),this.level2.addEventListener("levelThreeComplete",this.removeLevelThree,this)},p.removeLevelTwo=function(){this.level2.removeEventListener("levelThreeComplete",this.removeLevelThree,this),null!=this.level2&&(this.removeChild(this.level2),this.level2=null),this.level3=new LevelThree,this.addChild(this.level3),this.level3.addEventListener("levelThreeComplete",this.removeLevelThree,this)},p.removeLevelThree=function(){null!=this.level3&&this.removeChild(this.level3),this.level2&&this.removeChild(this.level2),this.level4=new LevelEnd,this.addChild(this.level4),this.level4.addEventListener("levelEndComplete",this.createGameScene,this)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var TextPORTAL=function(t){function e(e){t.call(this),this.vy=0,"p"==e&&(this.p=Factory.createBitmapByName("TextP"),this.addChild(this.p)),"o"==e&&(this.p=Factory.createBitmapByName("TextO"),this.addChild(this.p)),"r"==e&&(this.p=Factory.createBitmapByName("TextR"),this.addChild(this.p)),"t"==e&&(this.p=Factory.createBitmapByName("TextT"),this.addChild(this.p)),"a"==e&&(this.p=Factory.createBitmapByName("TextA"),this.addChild(this.p)),"l"==e&&(this.p=Factory.createBitmapByName("TextL"),this.addChild(this.p))}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(TextPORTAL,"TextPORTAL");var WuQi=function(t){function e(){t.call(this),this.wuqi=Factory.createBitmapByName("Wuqi"),this.addChild(this.wuqi),this.wuqi.anchorOffsetX=this.wuqi.width/2,this.wuqi.anchorOffsetY=this.wuqi.height/2}__extends(e,t);var r=e;return p=r.prototype,e}(egret.Sprite);egret.registerClass(WuQi,"WuQi");